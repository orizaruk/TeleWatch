services:
  telewatch:
    build: .
    container_name: telewatch
    restart: unless-stopped

    # Mount persistent data (session and config)
    volumes:
      - ./sesh.session:/app/sesh.session
      - ./config.json:/app/config.json

    # Telegram API credentials (required)
    environment:
      - API_ID=${API_ID}
      - API_HASH=${API_HASH}

      # Email notifications (optional)
      - EMAIL_ADDRESS=${EMAIL_ADDRESS:-}
      - EMAIL_APP_PASSWORD=${EMAIL_APP_PASSWORD:-}

      # Twilio SMS/WhatsApp (optional)
      - TWILIO_ACCOUNT_SID=${TWILIO_ACCOUNT_SID:-}
      - TWILIO_AUTH_TOKEN=${TWILIO_AUTH_TOKEN:-}
      - TWILIO_PHONE_NUMBER=${TWILIO_PHONE_NUMBER:-}
      - TWILIO_WHATSAPP_NUMBER=${TWILIO_WHATSAPP_NUMBER:-}

      # Config overrides (optional - override config.json values)
      # - TELEWATCH_CHATS=${TELEWATCH_CHATS:-}              # Comma-separated chat IDs
      # - TELEWATCH_KEYWORDS=${TELEWATCH_KEYWORDS:-}        # Comma-separated keywords
      # - TELEWATCH_DESTINATIONS=${TELEWATCH_DESTINATIONS:-}  # JSON string

    # Graceful shutdown (wait for SIGTERM handling)
    stop_grace_period: 10s
